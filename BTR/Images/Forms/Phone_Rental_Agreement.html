<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Device Rental Agreement</title>
<style>
    body { font-family: Arial, sans-serif; margin: 40px; }
    form { max-width: 600px; margin: auto; }
    label { display: block; margin-top: 15px; font-weight: bold; }
    input, textarea { width: 100%; padding: 8px; margin-top: 5px; box-sizing: border-box; }
    button { margin-top: 20px; padding: 10px 20px; font-size: 16px; }
    .signature { margin-top: 20px; text-align: center; }
    .signature img { max-width: 300px; }
</style>
</head>
<body>

<h1>Device Rental Agreement</h1>

<form id="rentalForm">
    <label for="deviceName">Device Model:</label>
    <input type="text" id="deviceName" name="deviceName" placeholder="Enter device model" required>

    <label for="renterName">Renter Name:</label>
    <input type="text" id="renterName" name="renterName" required>

    <label for="renterAddress">Renter Address:</label>
    <input type="text" id="renterAddress" name="renterAddress" required>

    <label for="renterDate">Date:</label>
    <input type="date" id="renterDate" name="renterDate" required>

    <div class="signature">
        <p>Signature:</p>
        <img src="/Signature/signature.png" alt="Signature">
    </div>

    <button type="button" onclick="submitForm()">Submit Agreement</button>
</form>

<script>
async function submitForm() {
    const data = {
        device: document.getElementById('deviceName').value,
        renter: document.getElementById('renterName').value,
        address: document.getElementById('renterAddress').value,
        date: document.getElementById('renterDate').value,
        signatureImage: "/Signature/signature.png"
    };

    // Save a local JSON copy for the user
    const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = `Agreement-${data.renter}-${Date.now()}.json`;
    a.click();

    // Trigger GitHub Actions workflow via repository_dispatch
    await fetch('https://api.github.com/repos/YOUR_USERNAME/YOUR_REPO/dispatches', {
        method: 'POST',
        headers: {
            'Accept': 'application/vnd.github.v3+json'
            // No token needed in client-side code
        },
        body: JSON.stringify({
            event_type: 'new_agreement',
            client_payload: data
        })
    });

    alert('Agreement submitted successfully!');
}
</script>

</body>
</html>
